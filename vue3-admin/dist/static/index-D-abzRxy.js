import{c as K,a as L,d as W,g as X}from"./index-Czxb3oi_.js";import{n as T,E,y as Y,r as Z,z as ee,A as ae,B as te}from"./element-Cx1u8HIB.js";import{u as le}from"./usePagination-DQcWKUV1.js";import{f as q}from"./index-DPHaodem.js";import{m as Q,r as _,ai as o,p as v,O as b,P as a,V as e,t as C,T as s,_ as ne,d as oe,aq as re,q as ie,Q as N,u as i,U as O,S as I}from"./vue-BoURs06I.js";import{_ as se}from"./index-Bd4y8G8I.js";import"./vxe-OnfnC8YF.js";const de={style:{flex:"auto"}},ue=Q({__name:"add_edit",emits:["ok"],setup(j,{expose:w,emit:r}){const h=_(!1),D={admin_id:void 0,username:"",password:"",nickname:"",status:1,roles:"editor"},l=_(T(D)),B={username:[{required:!0,trigger:"blur",message:"请输入账号"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}],nickname:[{required:!0,trigger:"blur",message:"请输入姓名"}]},x=_(null),V=_(!1),f=_(!1),A=d=>{h.value=!0,d&&(l.value=T(d))},p=()=>{h.value=!1},g=()=>{var d;(d=x.value)==null||d.validate((t,u)=>{if(!t)return console.log("表单校验不通过",u);V.value=!0,(l.value.admin_id===void 0?K:L)(l.value).then(()=>{E.success("操作成功"),h.value=!1,P("ok")}).finally(()=>{V.value=!1})})},S=()=>{var d;(d=x.value)==null||d.clearValidate(),l.value=T(D)},P=r;return w({open:A,isDetail:f}),(d,t)=>{const u=o("el-input"),k=o("el-form-item"),z=o("el-form"),c=o("el-button"),U=o("el-dialog");return v(),b(U,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=m=>h.value=m),width:"600",onClosed:S,title:f.value?"查看管理员信息":l.value.admin_id===void 0?"新增管理员":"修改管理员信息"},{default:a(()=>[e(z,{ref_key:"formRef",ref:x,model:l.value,disabled:f.value,rules:B,"label-width":"100px"},{default:a(()=>[e(k,{prop:"username",label:"账号"},{default:a(()=>[e(u,{modelValue:l.value.username,"onUpdate:modelValue":t[0]||(t[0]=m=>l.value.username=m),maxlength:"10","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(k,{prop:"password",label:"密码"},{default:a(()=>[e(u,{modelValue:l.value.password,"onUpdate:modelValue":t[1]||(t[1]=m=>l.value.password=m),maxlength:"20","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(k,{prop:"nickname",label:"姓名"},{default:a(()=>[e(u,{modelValue:l.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=m=>l.value.nickname=m),maxlength:"6","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"])]),footer:a(()=>[C("div",de,[e(c,{onClick:p},{default:a(()=>[s("取消")]),_:1}),e(c,{type:"primary",loading:V.value,disabled:f.value,onClick:g},{default:a(()=>[s("确定")]),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue","title"])}}}),ce={class:"app-container"},me={class:"toolbar-wrapper"},pe={class:"table-wrapper"},_e={class:"pager-wrapper"},fe=Q({name:"AdminManagement",__name:"index",setup(j){const w=_(!1),{paginationData:r,handleCurrentChange:h,handleSizeChange:D}=le(),l=_(),B=()=>{l.value.open(),l.value.isDetail=!1},x=t=>{te.confirm(`正在删除管理员：${t.nickname}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{W(t.admin_id).then(()=>{E.success("删除成功"),g()})})},V=t=>{l.value.open(t),l.value.isDetail=!1},f=_([]),A=_(null),p=ne({username:"",nickname:""}),g=()=>{w.value=!0,X({pageNum:r.currentPage,pageSize:r.pageSize,username:p.username||void 0,nickname:p.nickname||void 0}).then(({data:t})=>{r.total=t.total,f.value=t.list}).catch(()=>{f.value=[]}).finally(()=>{w.value=!1})},S=()=>{r.currentPage===1?g():r.currentPage=1},P=()=>{var t;(t=A.value)==null||t.resetFields(),S()},d=(t,u)=>{L({...t,status:u}).then(()=>{E.success("操作成功"),g()})};return oe([()=>r.currentPage,()=>r.pageSize],g,{immediate:!0}),(t,u)=>{const k=o("el-input"),z=o("el-form-item"),c=o("el-button"),U=o("el-form"),m=o("el-card"),G=o("el-tooltip"),y=o("el-table-column"),F=o("el-tag"),$=o("el-popconfirm"),H=o("el-table"),J=o("el-pagination"),R=re("loading");return v(),ie("div",ce,[N((v(),b(m,{shadow:"never",class:"search-wrapper"},{default:a(()=>[e(U,{ref_key:"searchFormRef",ref:A,inline:!0,model:p},{default:a(()=>[e(z,{prop:"username",label:"账号"},{default:a(()=>[e(k,{modelValue:p.username,"onUpdate:modelValue":u[0]||(u[0]=n=>p.username=n),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(z,{prop:"nickname",label:"姓名"},{default:a(()=>[e(k,{modelValue:p.nickname,"onUpdate:modelValue":u[1]||(u[1]=n=>p.nickname=n),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(z,null,{default:a(()=>[e(c,{type:"primary",icon:i(Y),onClick:S},{default:a(()=>[s("查询")]),_:1},8,["icon"]),e(c,{icon:i(Z),onClick:P},{default:a(()=>[s("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1})),[[R,w.value]]),N((v(),b(m,{shadow:"never"},{default:a(()=>[C("div",me,[C("div",null,[e(c,{type:"primary",icon:i(ee),onClick:B},{default:a(()=>[s("添加管理员")]),_:1},8,["icon"])]),C("div",null,[e(G,{content:"刷新当前页"},{default:a(()=>[e(c,{type:"primary",icon:i(ae),circle:"",onClick:g},null,8,["icon"])]),_:1})])]),C("div",pe,[e(H,{data:f.value},{default:a(()=>[e(y,{prop:"username",fixed:"",label:"账号",width:"150"}),e(y,{prop:"nickname",label:"姓名",width:"150"}),e(y,{prop:"expire",label:"状态",width:"150"},{default:a(n=>[n.row.status===1?(v(),b(F,{key:0,type:"success",effect:"dark"},{default:a(()=>[s(" 正常 ")]),_:1})):(v(),b(F,{key:1,type:"danger",effect:"dark"},{default:a(()=>[s(" 已禁用 ")]),_:1}))]),_:1}),e(y,{prop:"create_time",label:"创建时间","min-width":"200"},{default:a(n=>[s(O(i(q)(n.row.create_time)),1)]),_:1}),e(y,{prop:"update_time",label:"更新时间","min-width":"200"},{default:a(n=>[s(O(i(q)(n.row.update_time)),1)]),_:1}),e(y,{fixed:"right",label:"操作",width:"200",align:"center"},{default:a(n=>[e($,{title:"确定禁用?",onConfirm:M=>d(n.row,2)},{reference:a(()=>[n.row.status===1?(v(),b(c,{key:0,type:"warning",text:"",bg:"",size:"small"},{default:a(()=>[s("禁用")]),_:1})):I("",!0)]),_:2},1032,["onConfirm"]),e($,{title:"确定解除?",onConfirm:M=>d(n.row,1)},{reference:a(()=>[n.row.status!==1?(v(),b(c,{key:0,type:"success",text:"",bg:"",size:"small"},{default:a(()=>[s("解除")]),_:1})):I("",!0)]),_:2},1032,["onConfirm"]),e(c,{type:"primary",text:"",bg:"",size:"small",onClick:M=>V(n.row)},{default:a(()=>[s("修改")]),_:2},1032,["onClick"]),e(c,{type:"danger",text:"",bg:"",size:"small",onClick:M=>x(n.row)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),C("div",_e,[e(J,{background:"",layout:i(r).layout,"page-sizes":i(r).pageSizes,total:i(r).total,"page-size":i(r).pageSize,currentPage:i(r).currentPage,onSizeChange:i(D),onCurrentChange:i(h)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[R,w.value]]),e(ue,{ref_key:"addEdit",ref:l,onOk:g},null,512)])}}}),Ce=se(fe,[["__scopeId","data-v-b1431372"]]);export{Ce as default};
